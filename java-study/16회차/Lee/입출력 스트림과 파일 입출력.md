# 8. 입출력 스트림과 파일 입출력

## 자바의 입출력 스트림

### 스트림 입출력이란?
스트림이란 연속적인 데이터의 흐름 혹은 데이터를 전송하는 소프트웨어 모듈을 말한다.  
자바에서 입ㆍ출력 스트림은 응용프로그램과 입출력 장치를 연결하는 소프트웨어 모듈이다.

입출력 스트림의 특징  
1. 스트림의 양끝에는 입출력 장치와 자바 응용프로그램이 연결된다.
   - 자바 응용프로그램은 입력 스트림과 출력 스트림만 연결하고, 입출력 스트림이 입출력 장치를 제어하고 실질적인 입출력을 담당한다.
2. 스트림은 단방향이다.
   - 입력 스트림은 입력 장치에서 응용프로그램으로 데이터를 전송하며, 출력 스트림은 응용프로그램으로부터 받은 데이터를 출력 장치로 전송한다. 두 가지 기능을 모두 가진 스트림은 없다.
3. 스트림을 통해 흘러가는 기본 단위는 바이트나 문자이다.
   - 입력 스트림에 먼저 들어온 데이터가 응용프로그램에 먼저 전달되고, 출력 스트림은 응용프로그램이 출력한 순서대로 출력 장치에 보낸다.
4. 스트림은 선입선출, 즉 FIFO 구조이다.
   - 입력 스트림에 먼저 들어온 데이터가 응용프로그램에 먼저 전달되고, 출력 스트림은 응용프로그램이 출력한 순서대로 출력 장치에 보낸다.

### 바이트 스트림과 문자 스트림
자바에서 입출력 스트림은 문자 스트림과 바이트 스트림의 2종류로 나뉜다. 문자 스트림은 문자만 다루기 때문에, 문자가 아닌 데이터가 출력되면 보이지 않거나 엉뚱한 기호가 출력되며, 문자가 아닌 정보가 입력되면 응용프로그램에게 엉뚱한 문자가 전달되는 오류가 발생한다. 참고로 자바에서 char 타입, 즉 문자 하나의 크기는 2바이트이다. 바이트 스트림은 바이트를 단위로 다루는 스트림으로, 스트림에 들어오고 나가는 정보를 단순 바이너리(비트들)로 다루기 때문에, 문자이든 이미지 바이트든 상관없이 흘려보낸다.
바이트 스트림을 다루는 클래스는 공통적으로 이름 뒤에 Stream을 붙이고, 문자 스트림을 다루는 클래스는 Reader/Writer를 붙여 구분한다.

### 스트림 연결
스트림은 서로 연결될 수 있다.

첫 번째 코드는 키보드로부터 문자를 입력받기 위해 표준 입력 스트림인 System.in과 InputStreamReader 스트림 객체를 연결하는 코드이다.  
두 번째 코드는 입력 스트림으로부터 키를 입력받는다. c는 입력된 키의 문자 값이다.
```java
InputStreamReader rd = new InputStreamReader(System.in);

int c = rd.read();
```
***

## 문자 스트림과 파일 입출력

### 문자 스트림 클래스
문자 스트림은 2바이트의 유니코드 문자를 단위로 입출력하는 스트림이다. 문자화되지 않는 바이너리 바이트 값들을 문자 스트림 클래스에서 처리할 수 없다. 따라서 이미지와 같은 바이너리 정보는 처리할 수 없다. 따라서 이미지와 같은 바이너리 정보는 처리할 수 없다. 문자 입력 스트림은 바이트들을 전달받고, 이 바이트들을 '로컬 문자 집합'에 있는 문자인지 비교하여 문자로 변환한다.
***

## 바이트 스트림과 파일 입출력

### 바이트 스트림 클래스
바이트 스트림은 바이트 단위로 바이너리 데이터가 흐르는 시스템이다. 바이트 스트림은 바이너리 데이터를 있는 그대로 입출력하기 때문에 이미지나 동영상 파일 입출력에 필수적이고, 문자들로 구성된 텍스트 파일도 입출력할 수 있다.

대표적인 바이트 입출력 스트림 클래스
- InputStream/OutputStream
  - 추상 클래스이며, 바이트 입출력 처리를 위한 공통 기능을 가진 부모 클래스이다.

- FileInputStream/FileOutputStream
  - 파일 입출력을 위한 클래스로서, 파일로부터 바이너리 데이터를 읽거나 파일에 바이너리 데이터를 저장할 수 있다.

- DataInputStream/DataOutputStream
  - 이 스트림을 이용하면 boolean, char, byte, short, int, long, float, double 타입의 값을 바이너리 형태로 입출력한다. 문자열도 바이너리 형태로 입출력한다.
***

## 버퍼 입출력과 파일 입출력

### 버퍼 입출력의 필요성
입출력 스트림은 운영체제 API를 호출하여 입출력 장치와 프로그램 사이에서 데이터가 전송되도록 한다. 파일 쓰기 메소드는 최종적으로 운영체제 API를 호출하여 파일에 쓰도록 시키고, 운영체제 API는 하드 디스크에게 명령을 내려 파일에 데이터를 기록한다. 자주 운영체제 API가 호출될수록 하드 디스크 장치나 네트워크 장치가 자주 작동하게 되어 시스템의 효율을 나빠지고 프로그램 역시 여러 번 입출력을 진행해야 하므로 입출력의 실행 속도가 떨어진다. 만일 스트림이 버퍼를 가지게 되면 보다 효율적으로 작동할 수 있다. 버퍼란 데이터를 일시적으로 저장하기 위한 메모리이다. 파일 출력 스트림이 파일에 쓸 데이터를 버퍼에 모아 두었다가, 한 번에 운영체제 API를 호출하여 파일에 쓰게 하면, 운영체제의 부담을 줄이고 장치를 구동하는 일이 줄어들게 되어 시스템의 속도나 효율이 올라가게 된다.  
버퍼 입출력이란 입출력 스트림이 버퍼를 가지고 보다 효율적으로 입출력을 처리하는 방식이다. 버퍼를 가지는 스트림을 버퍼 스트림이라고 부른다. 버퍼 입력 스트림은 입력 장치로부터 입력된 데이터를 버퍼에 모아서 프로그램으로 보내며, 버퍼 출력 스트림은 프로그램에서 출력한 데이터를 역시 버퍼에 모아 두었다가 한 번에 출력 장치에 출력한다.  
버퍼 스트림 역시 데이터의 타입에 따라 바이트 버퍼 스트림과 문자 버퍼 스트림으로 구분된다.